apiVersion: traefik.io/v1alpha1
kind: IngressRoute
metadata:
  name: markmine-redirect
  namespace: markmine-dev
spec:
  entryPoints:
    - websecure
  routes:
    # Match /:org/:slug but EXCLUDE reserved paths like /api/*, /login/*, etc
    - match: Host(`markmine.leotsgo.dev`) && PathRegexp(`^/(?!api|health|login|dashboard|links|settings|assets)[a-zA-Z0-9_-]+/[a-zA-Z0-9_-]+$`)
      kind: Rule
      priority: 100
      services:
        - name: markmine-backend
          port: 3000
  tls:
    secretName: markmine-dev-tls
